<div class="modal fade" id="addUser" tabindex="-1" role="modal" aria-labelledby="modal-label" aria-hidden="true" style="display: none; overflow-y: auto !important;">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
			</div>
			<div class="modal-body">
				<div class="row">
					<div class="col-sm-12">
						<h4 class="fr text-green">Ajouter un utilisateur</h4>
						<form id="widget-addUser-form" action="apis/Kameo/add_user.php" role="form" method="post">
							<div class="form-group col-sm-12">
								<div class="col-md-4">
									<label for="firstname" class="fr">Prénom</label>
									<label for="firstname" class="en">Firstname</label>
									<label for="firstname" class="nl">Voornaam</label>
									<input type="text" name="firstName" class="form-control required">
								</div>
								<div class="col-md-4">
									<label for="name" class="fr">Nom</label>
									<label for="name" class="en">Name</label>
									<label for="name" class="nl">Achternaam</label>
									<input type="text" name="name" class="form-control required">
								</div>
								<div class="col-md-4">
									<label for="mail" class="fr">E-mail</label>
									<label for="mail" class="en">E-mail</label>
									<label for="mail" class="nl">E-mail</label>
									<input type="text" name="mail" class="form-control mail required">
								</div>
								<div class="col-md-4">
									<label for="generatePassword" class="fr">Genérer un password automatiquement</label>
									<input type="checkbox" name="generatePassword" class="form-control" checked>
								</div>
								<div class="col-md-8">
									<label for="password" class="fr hidden">Password</label>
									<label for="password" class="en hidden">Password</label>
									<label for="password" class="nl hidden">Password</label>
									<input type="password" name="password" id="manual_password" class="form-control required hidden">
								</div>
								<div class="col-md-4">
									<label for="fleetManager">Fleet manager</label>
									<input type="checkbox" name="fleetManager" class="form-control">
								</div>
								<input type="text" name="requestor" class="form-control hidden" value="<?php echo $user_data['EMAIL']; ?>">
								<input type="text" name="company" class="form-control hidden">
							</div>
							<h4>Accès aux bâtiments</h4>
							<div class="form-group col-sm-12" id="buildingCreateUser"></div>
							<h4>Accès aux vélos</h4>
							<div class="form-group col-sm-12" id="bikeCreateUser"></div>
							<div id="confirmAddUser"></div>
						</form>
					</div>
				</div>
			</div>
			<div class="fr" class="modal-footer">
				<button type="button" class="btn btn-b" data-dismiss="modal">Fermer</button>
			</div>
			<div class="en" class="modal-footer">
				<button type="button" class="btn btn-b" data-dismiss="modal">Close</button>
			</div>
			<div class="nl" class="modal-footer">
				<button type="button" class="btn btn-b" data-dismiss="modal">Sluiten</button>
			</div>
		</div>
	</div>
</div>
<!--<script type="text/javascript" src="js/addons/tweetnacl/nacl-fast.min.js"></script>
<script type="text/javascript" src="js/addons/tweetnacl-util/nacl-util.min.js"></script>-->
<script type="text/javascript">
	$('#widget-addUser-form input[name=generatePassword]').change(function(){
	 if($('#widget-addUser-form input[name=generatePassword').is(':checked')){
		$('#widget-addUser-form label[for=password]').addClass("hidden");
		$('#widget-addUser-form input[name=password]').addClass("hidden");
	 }else{
		$('#widget-addUser-form label[for=password]').removeClass("hidden");
		$('#widget-addUser-form input[name=password]').removeClass("hidden");
	 }
	});
	jQuery("#widget-addUser-form").submit(function() {
	  document.getElementById('manual_password').value = /*nacl.util.encodeBase64(
		  nacl.hash(
			  nacl.util.decodeUTF8(*/
				document.getElementById('manual_password').value
			  /*)
		  )
	  )*/;
	  return true;
	});
	jQuery("#widget-addUser-form").validate({
	 submitHandler: function(form) {
		jQuery(form).ajaxSubmit({
		 success: function(response) {
			if (response.response == 'success') {
			 $.notify({
				message: response.message
			 }, {
				type: 'success'
			 });
			 get_users_listing();
			 $('#addUser').modal('toggle');
			 document.getElementById('widget-addUser-form').reset();
			} else {
			 $.notify({
				message: response.message
			 }, {
				type: 'danger'
			 });
			}
		 }
		});
	 }
	});
</script>